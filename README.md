# CameraMonitor

**CameraMonitor** ‚Äî Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞–º–µ—Ä—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –µ—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç.

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞–º–µ—Ä—ã**  
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–æ–≥–¥–∞ —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è –∏–ª–∏ –∑–∞–¥–Ω—è—è –∫–∞–º–µ—Ä–∞ –∞–∫—Ç–∏–≤–Ω–∞.
   - –í—ã–≤–æ–¥–∏—Ç –ø–∞–∫–µ—Ç –∏ (–ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏) –∏–º—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ –∫–∞–º–µ—Ä—É.

2. **–§–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º**  
   - –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ foreground mode —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º, —á—Ç–æ–±—ã –Ω–µ –≤—ã–≥—Ä—É–∂–∞—Ç—å—Å—è —Å–∏—Å—Ç–µ–º–æ–π.
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∫–∞–º–µ—Ä—ã (–∫–∞–∫–∞—è –∫–∞–º–µ—Ä–∞ –∑–∞–Ω—è—Ç–∞ –∏ –∫–∞–∫–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º).

3. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Android 10, 11, 12+**  
   - –î–ª—è API ‚â• 23 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `AppOpsManager` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è UID –ø–∞–∫–µ—Ç–∞, –Ω–∞—á–∞–≤—à–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–º–µ—Ä—É.
   - –î–ª—è API 21‚Äì22 (–∏ —Ç–∞–º, –≥–¥–µ `AppOpsManager` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `CameraManager` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–∞–º–µ—Ä—ã, –Ω–æ –±–µ–∑ —Ç–æ—á–Ω–æ–π –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –ø–∞–∫–µ—Ç—É.

4. **UI (–ø–æ –∂–µ–ª–∞–Ω–∏—é)**  
   - MainActivity –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é (–ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è: –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–º–µ—Ä—ã –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ).
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç—ë–º–Ω–æ–π —Ç–µ–º—ã (–≤ —Ä–µ—Å—É—Ä—Å–∞—Ö themes.xml).

5. **–ë–æ–Ω—É—Å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**  
   - –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä—ã (–∫—Ä–∞—Ç–∫–∏–π –ª–æ–≥ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π).
   - –¢—ë–º–Ω–∞—è –∏ —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞.

---

## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Min SDK:** 21  
- **Target SDK:** 33  
- **–Ø–∑—ã–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** Kotlin  
- **UI:** XML (–º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ Jetpack Compose –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏)  
- **Gradle:** Android Gradle Plugin 7.3+ / Kotlin 1.7+  

---

## üìù –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–í `AndroidManifest.xml`:

```xml
<uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
<uses-permission android:name="android.permission.WAKE_LOCK" />
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ.** –ü—Ä—è–º–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (`PACKAGE_USAGE_STATS`) –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è, —Ç–∞–∫ –∫–∞–∫ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º `AppOpsManager` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∞ `OPSTR_CAMERA`. –¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ—à–∏–≤–∫–∞—Ö —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∞–≤–æ ¬´Usage access¬ª –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã, –Ω–æ –Ω–∞ —á–∏—Å—Ç—ã—Ö AOSP –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ Android 10+ –ø—Ä–æ–±–ª–µ–º –Ω–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç.

---

## üöÄ –ö–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

   ```bash
   git clone https://github.com/yourusername/CameraMonitor.git
   cd CameraMonitor
   ```
2. **–û—Ç–∫—Ä—ã—Ç—å –≤ Android Studio**
   –§–∞–π–ª –ø—Ä–æ–µ–∫—Ç–∞: `CameraMonitor/settings.gradle`
3. **–°–æ–±—Ä–∞—Ç—å (Build ‚Üí Make Project) –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ**
   –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–¥ Android 6.0+ (API 23+) –¥–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏.

---

## üìÇ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

* **MainActivity.kt**
  ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç/–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `CameraMonitorService`, –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ª–æ–≥ —Å–æ–±—ã—Ç–∏–π (–∫–∞–∫–∞—è –∫–∞–º–µ—Ä–∞, –∫–∞–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ).

* **CameraMonitorService.kt**
  ‚Äî foreground-—Å–µ—Ä–≤–∏—Å, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç:

  1. `CameraManager.AvailabilityCallback` –¥–ª—è API 21+,
  2. `AppOpsManager.OnOpChangedListener` –¥–ª—è API 23+ (–æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–∞–º–µ—Ä–æ–π: `OPSTR_CAMERA`).

  –ù–∞ –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç broadcast —Å –¥–µ—Ç–∞–ª—è–º–∏.

* **CameraBroadcastReceiver.kt**
  ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç broadcast –∏–∑ —Å–µ—Ä–≤–∏—Å–∞, –ø–µ—Ä–µ–¥–∞—ë—Ç –¥–∞–Ω–Ω—ã–µ –≤ UI (MainActivity).

* **NotificationHelper.kt**
  ‚Äî —Å–æ–∑–¥–∞—ë—Ç –∫–∞–Ω–∞–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ —Å—Ç—Ä–æ–∏—Ç —Å–∞–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å —Ç–µ–∫—É—â–∏–º —Å—Ç–∞—Ç—É—Å–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–º–µ—Ä—ã.

---

## üì¶ –ì–æ—Ç–æ–≤—ã–π –∫ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ GitHub

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ –∫–æ—Ä–Ω–µ –µ—Å—Ç—å `README.md` —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏, –∫–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å.
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.gitignore` –≤—Ö–æ–¥—è—Ç:

   ```
   *.iml
   /.gradle/
   /local.properties
   ```

3. –ó–∞–ø—É—à—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
   ```bash
   git add .
   git commit -m "Initial commit: CameraMonitor project"
   git push origin main
   ```

---

**–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã**

* –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç ¬´Start Monitoring¬ª (MainActivity).
* –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ foreground, –ø–æ—è–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ¬´CameraMonitor: –ö–∞–º–µ—Ä–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è¬ª.
* –ö–æ–≥–¥–∞ –ª—é–±–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∫–∞–º–µ—Ä—É, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è:

  ```
  CameraMonitor: –ö–∞–º–µ—Ä–∞ –∑–∞–Ω—è—Ç–∞
  –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: com.example.cameraapp
  –ö–∞–º–µ—Ä–∞: –§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è
  ```
* MainActivity (–µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–∞) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–æ–±—ã—Ç–∏–π –≤ RecyclerView (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ TextView).

---

# –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
